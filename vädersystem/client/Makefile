# Makefile f√∂r V√§derklient
# ============================================================================
# Byggkommandon f√∂r C++ v√§derklieneten
# Anv√§ndning:
#   make           - Bygg C++-klienten (default)
#   make run       - K√∂r interaktiv v√§dermeny
#   make client    - Bygg C++-klienten
#   make test      - Testa klient med Stockholm
#   make clean     - Rensa byggfiler
#   make help      - Visa hj√§lp
# ============================================================================

# Kompilatorkonfiguration
CXX = g++
CXXFLAGS = -Wall -Wextra -I../include -std=c++11 -g

# Plattformsspecifika inst√§llningar
ifeq ($(OS),Windows_NT)
    LDFLAGS = -lws2_32
    CLIENT_CPP = weather_client_cpp.exe
    VADER_SCRIPT = vader.sh
    RM = del /Q
else
    LDFLAGS =
    CLIENT_CPP = weather_client_cpp
    VADER_SCRIPT = vader.sh
    RM = rm -f
endif

# K√§llfiler
CLIENT_CPP_SRC = weather_client.cpp
CLIENT_CPP_OBJ = weather_client.o

# ============================================================================
# PHONY TARGETS
# ============================================================================
.PHONY: all client run test clean help

# ============================================================================
# HUVUDM√ÖL
# ============================================================================

# Default: bygg klient
all: client

# Bygg C++-klient
client: $(CLIENT_CPP)
	@echo ""
	@echo "‚úÖ C++-klient byggd: $(CLIENT_CPP)"
	@echo ""
	@echo "üí° Kr√§ver att servern k√∂rs p√• localhost:8080"
	@echo "üí° Starta server: cd .. && make run"
	@echo ""
	@echo "K√∂r 'make run' f√∂r interaktiv meny"
	@echo "K√∂r './$(CLIENT_CPP) Stockholm SE' f√∂r direkt anv√§ndning"
	@echo ""

# ============================================================================
# BYGGREGLER
# ============================================================================

# L√§nka C++-klient
$(CLIENT_CPP): $(CLIENT_CPP_OBJ)
	@echo "L√§nkar C++-klient..."
	@$(CXX) $(CXXFLAGS) -o $@ $^ $(LDFLAGS)

# Kompilera C++-fil
weather_client.o: weather_client.cpp
	@echo "Kompilerar $<..."
	@$(CXX) $(CXXFLAGS) -c $< -o $@

# ============================================================================
# K√ñRNING
# ============================================================================

# K√∂r interaktiv v√§dermeny (HUVUDKOMMANDO)
run: client
	@echo ""
	@echo "‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó"
	@echo "‚ïë          STARTAR INTERAKTIV V√ÑDERKLIENT              ‚ïë"
	@echo "‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù"
	@echo ""
	@echo "üí° Ansluter till server p√• localhost:8080"
	@echo "üí° Servern h√§mtar data fr√•n OpenWeatherMap API"
	@echo "üí° Skriv stad-namnet f√∂r att f√• v√§dret!"
	@echo "üí° Exempel: 'Lule√•' eller 'London GB'"
	@echo ""
	@echo "‚ö†Ô∏è  OBS: Kontrollera att servern k√∂rs f√∂rst!"
	@echo "   Starta server: cd .. && make run"
	@echo ""
	@./$(CLIENT_CPP)

# Testa klient med Stockholm
test: client
	@echo ""
	@echo "‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó"
	@echo "‚ïë          TESTAR V√ÑDERKLIENT                          ‚ïë"
	@echo "‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù"
	@echo ""
	@echo "üìç H√§mtar v√§der f√∂r Stockholm, SE..."
	@echo ""
	@./$(CLIENT_CPP) Stockholm SE

# ============================================================================
# RENSNING
# ============================================================================

clean:
	@echo "üßπ Rensar byggfiler..."
	$(RM) $(CLIENT_CPP_OBJ) $(CLIENT_CPP)
	@echo "‚úÖ Rensning klar"

# ============================================================================
# HJ√ÑLP
# ============================================================================

help:
	@echo ""
	@echo "‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó"
	@echo "‚ïë          V√ÑDERKLIENT MAKEFILE - HJ√ÑLP                ‚ïë"
	@echo "‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù"
	@echo ""
	@echo "BYGGKOMMANDON:"
	@echo "  make              - Bygg C++-klienten (default)"
	@echo "  make client       - Bygg C++-klienten"
	@echo ""
	@echo "K√ñRNING:"
	@echo "  make run          - K√∂r interaktiv v√§dermeny (60+ st√§der)"
	@echo "  make test         - Testa klient med Stockholm"
	@echo ""
	@echo "RENSNING:"
	@echo "  make clean        - Rensa byggfiler"
	@echo ""
	@echo "MANUELL ANV√ÑNDNING:"
	@echo "  ./$(CLIENT_CPP) [stad] [landskod]"
	@echo ""
	@echo "EXEMPEL:"
	@echo "  make run                           # Interaktiv meny"
	@echo "  ./$(CLIENT_CPP) London GB          # London"
	@echo "  ./$(CLIENT_CPP) Paris FR           # Paris"
	@echo "  ./$(CLIENT_CPP) \"New York\" US      # New York"
	@echo ""
	@echo "TILLG√ÑNGLIGA ST√ÑDER I MENYN:"
	@echo "  - 60 svenska st√§der (Stockholm, G√∂teborg, Malm√∂...)"
	@echo "  - 10 internationella (London, Paris, Berlin...)"
	@echo "  - Egen stad (skriv egen stad + landskod)"
	@echo ""
